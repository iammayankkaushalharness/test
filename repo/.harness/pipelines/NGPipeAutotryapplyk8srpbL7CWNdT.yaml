pipeline:
  name: tryapplyk8s
  identifier: NGPipeAutotryapplyk8srpbL7CWNdT
  description: ''
  tags: {
    }
  stages:
  - stage:
      name: stage 1
      identifier: stage_1
      description: ''
      type: Deployment
      spec:
        serviceConfig:
          serviceDefinition:
            spec:
              artifacts:
                sidecars: [
                  ]
                primary:
                  type: DockerRegistry
                  spec:
                    connectorRef: org.DockerConnectorForAutomationTest
                    imagePath: harness/todolist-sample
                    tag: '10'
              manifests:
              - manifest:
                  identifier: manifest
                  type: K8sManifest
                  spec:
                    store:
                      type: Git
                      spec:
                        connectorRef: org.GitConnectorForAutomationTest
                        gitFetchType: Branch
                        branch: master
                        paths:
                        - ng-automation/k8s/templates/
              - manifest:
                  identifier: values
                  type: Values
                  spec:
                    store:
                      type: Git
                      spec:
                        connectorRef: org.GitConnectorForAutomationTest
                        gitFetchType: Branch
                        branch: master
                        paths:
                        - ng-automation/k8s/valuesWithClusterTypeService.yaml
            type: Kubernetes
          service:
            name: service 1
            identifier: service_1
          stageOverrides:
            manifests: [
              ]
        infrastructure:
          environment:
            name: env 1
            identifier: env_1
            type: PreProduction
          allowSimultaneousDeployments: true
          infrastructureDefinition:
            type: KubernetesDirect
            spec:
              connectorRef: org.KubernetesConnectorForAutomationTest
              namespace: cdp-k8s-qa-sanity
              releaseName: releasename-915824
        execution:
          steps:
          - step:
              type: K8sApply
              name: apply step
              identifier: apply_step
              timeout: 5m
              spec:
                filePaths:
                - namespace.yaml
                - service.yaml
                skipDryRun: false
                skipSteadyStateCheck: false
          rollbackSteps: [
            ]
      tags: {
        }
      variables:
      - name: resourceNamePrefix
        type: String
        value: cdpsanitysuites-qwerandom
      failureStrategies:
      - onFailure:
          errors:
          - AllErrors
          action:
            type: StageRollback
  projectIdentifier: NGPipeAutoDemoPro17wJ6te9Bo
  orgIdentifier: Ng_Pipelines_K8s_Organisations
